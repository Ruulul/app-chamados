{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\LORENA UBS\\\\app-chamados\\\\client\\\\src\\\\Pages\\\\TheMain.js\";\nimport React from \"react\";\nimport axios from 'axios';\nimport UpBar from \"../components/UpBar\";\nimport SideBar from \"../components/SideBar\";\nimport Requisicao from \"../components/Requisicao\";\nimport Home from \"./Home\";\nimport Filtro from \"./FiltroServico\";\nimport Chamado from \"./Chamado\";\nimport { Grid, Divider } from \"@mui/material\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass TheMain extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      servicos: [],\n      aberto: -1\n    };\n    this.servico = this.servico.bind(this);\n    this.adicionaservico = this.adicionaservico.bind(this);\n    this.abreservico = this.abreservico.bind(this);\n    this.removeservico = this.removeservico.bind(this);\n    this.atualizaservico = this.atualizaservico.bind(this);\n    this.salvaservico = this.salvaservico.bind(this);\n    this.altera_status_servico = this.altera_status_servico.bind(this);\n    this.exibe_pagina = this.exibe_pagina.bind(this);\n    this.ir_para_pagina = this.ir_para_pagina.bind(this);\n    this.troca_aba = this.troca_aba.bind(this);\n    this.fechar_aba = this.fechar_aba.bind(this);\n    this.servicos = this.servicos.bind(this);\n  }\n\n  adicionaservico() {\n    let servico = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    let actualServicos = this.state.servicos;\n    let pos = actualServicos.length;\n\n    if (servico) {\n      servico.editando = true;\n      actualServicos[pos] = servico;\n    } else actualServicos[pos] = {\n      departamento: \"Contábil\",\n      prioridade: 1,\n      anexo: undefined,\n      assunto: \"\",\n      chat: [{\n        usuario: \"\",\n        mensagem: \"\"\n      }],\n      id: this.geraidservico(pos),\n      status: \"pendente\",\n      editando: false\n    };\n\n    this.setState({\n      servicos: [],\n      aberto: -1\n    }, () => {\n      this.setState({\n        servicos: actualServicos,\n        aberto: pos\n      });\n    });\n  }\n\n  abreservico(id) {\n    let servico = JSON.parse(localStorage[id]);\n    this.adicionaservico(servico);\n  }\n\n  troca_aba(pos) {\n    this.setState({\n      aberto: -1\n    }, () => {\n      this.setState({\n        aberto: pos\n      });\n    });\n  }\n\n  removeservico(pos) {\n    console.log(\"Removing \" + pos + \"º element\");\n    let actualServicos = this.state.servicos;\n    let ppos = pos === this.state.servicos.length - 1 ? -2 : actualServicos.length - 2;\n    actualServicos.splice(pos, 1);\n    this.setState({\n      servicos: [],\n      aberto: -1\n    }, () => {\n      this.setState({\n        servicos: actualServicos,\n        aberto: ppos\n      });\n    });\n  }\n\n  atualizaservico(pos, atual) {\n    let actualServicos = this.state.servicos;\n    actualServicos[pos] = atual;\n    this.setState({\n      servicos: actualServicos\n    });\n    console.log(\"Assunto: \" + atual.assunto + \"\\nMensagem: \" + atual.chat[0].mensagem + \"\\nUsuário: \" + atual.chat[0].usuario + \"\\nEditando? \" + atual.editando + \"\\nPrioridade: \" + atual.prioridade + \"\\nStatus: \" + atual.status);\n  }\n\n  salvaservico(req) {\n    axios.post('/api/novo/servico', req).then(res => console.log('Serviço salvo: ' + res)).catch(err => console.error('Falha em salvar o serviço'));\n    this.setState({}, () => this.setState({}));\n  }\n\n  geraidservico(n) {\n    return parseInt((n + 1) / 13 * 1000, 10);\n  }\n\n  fechar_aba() {\n    this.setState({\n      servicos: [],\n      aberto: -1\n    }, () => {\n      this.setState({\n        servicos: [],\n        aberto: -1\n      });\n    });\n  }\n\n  servico() {\n    let aberto = this.state.aberto;\n    console.log(\"Aberto na posição \" + aberto);\n    let infos = aberto !== -1 ? this.state.servicos[aberto] : {\n      departamento: \"Contábil\",\n      prioridade: 1,\n      anexo: undefined,\n      assunto: \"\",\n      chat: [{\n        usuario: \"\",\n        mensagem: \"\"\n      }],\n      id: this.geraidservico(aberto),\n      status: \"pendente\",\n      editando: false\n    };\n    return !infos.editando ? /*#__PURE__*/_jsxDEV(Requisicao, {\n      infos: infos,\n      fechar: this.removeservico,\n      atualizar: this.atualizaservico,\n      enviar: this.salvaservico,\n      pos: aberto,\n      this: this\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 7\n    }, this) : /*#__PURE__*/_jsxDEV(Chamado, {\n      mudastatus: this.altera_status_servico,\n      infos: infos,\n      atualiza: this.salvaservico\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }, this);\n  }\n\n  home() {\n    return /*#__PURE__*/_jsxDEV(Home, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 12\n    }, this);\n  }\n\n  altera_status_servico(servico) {\n    switch (servico.status) {\n      case \"pendente\":\n        servico.status = \"resolvido\";\n        break;\n\n      case \"resolvido\":\n        servico.status = \"fechado\";\n        break;\n\n      case \"fechado\":\n        alert(\"Isso não devia aparecer\");\n        break;\n\n      default:\n        alert(\"Isso definitivamente não devia aparecer\");\n    }\n\n    if (servico) this.salvaservico(servico);\n  }\n\n  servicos() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Filtro, {\n        ir_para_pagina: this.abreservico,\n        acao: (e, s) => {\n          this.altera_status_servico(e, s);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 7\n    }, this);\n  }\n\n  ir_para_pagina(n) {\n    this.setState({\n      aberto: n\n    });\n  }\n\n  exibe_pagina(n) {\n    switch (n) {\n      case -2:\n        return this.servicos();\n\n      case -1:\n        return this.home();\n\n      default:\n        return this.servico();\n    }\n  }\n\n  render() {\n    let aberto = this.state.aberto;\n    return /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      orientation: \"row\",\n      spacing: 1,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        item: true,\n        xs: 12,\n        justifyContent: \"center\",\n        children: /*#__PURE__*/_jsxDEV(UpBar, {\n          servicos: this.state.servicos,\n          plus: this.adicionaservico,\n          close: this.fechar_aba,\n          switch: this.troca_aba\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 0,\n        md: 0\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 12,\n        md: 1,\n        children: /*#__PURE__*/_jsxDEV(SideBar, {\n          this: this,\n          ir_para_pagina: this.ir_para_pagina\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        sx: {\n          width: 1,\n          padding: 0\n        },\n        sm: 12,\n        md: 10,\n        children: [/*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 11\n        }, this), this.exibe_pagina(aberto)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default TheMain;","map":{"version":3,"sources":["C:/Users/LORENA UBS/app-chamados/client/src/Pages/TheMain.js"],"names":["React","axios","UpBar","SideBar","Requisicao","Home","Filtro","Chamado","Grid","Divider","TheMain","Component","constructor","props","state","servicos","aberto","servico","bind","adicionaservico","abreservico","removeservico","atualizaservico","salvaservico","altera_status_servico","exibe_pagina","ir_para_pagina","troca_aba","fechar_aba","actualServicos","pos","length","editando","departamento","prioridade","anexo","undefined","assunto","chat","usuario","mensagem","id","geraidservico","status","setState","JSON","parse","localStorage","console","log","ppos","splice","atual","req","post","then","res","catch","err","error","n","parseInt","infos","home","alert","display","e","s","render","width","padding"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport axios from 'axios';\r\nimport UpBar from \"../components/UpBar\";\r\nimport SideBar from \"../components/SideBar\";\r\nimport Requisicao from \"../components/Requisicao\";\r\nimport Home from \"./Home\";\r\nimport Filtro from \"./FiltroServico\";\r\nimport Chamado from \"./Chamado\";\r\n\r\nimport { Grid, Divider } from \"@mui/material\";\r\n\r\nclass TheMain extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      servicos: [],\r\n      aberto: -1\r\n    };\r\n\r\n    this.servico = this.servico.bind(this);\r\n    this.adicionaservico = this.adicionaservico.bind(this);\r\n    this.abreservico = this.abreservico.bind(this);\r\n    this.removeservico = this.removeservico.bind(this);\r\n    this.atualizaservico = this.atualizaservico.bind(this);\r\n    this.salvaservico = this.salvaservico.bind(this);\r\n    this.altera_status_servico = this.altera_status_servico.bind(this);\r\n\r\n    this.exibe_pagina = this.exibe_pagina.bind(this);\r\n    this.ir_para_pagina = this.ir_para_pagina.bind(this);\r\n    this.troca_aba = this.troca_aba.bind(this);\r\n    this.fechar_aba = this.fechar_aba.bind(this);\r\n\r\n    this.servicos = this.servicos.bind(this);\r\n  }\r\n\r\n  adicionaservico(servico = null) {\r\n    let actualServicos = this.state.servicos;\r\n    let pos = actualServicos.length;\r\n    if (servico) {\r\n      servico.editando = true;\r\n      actualServicos[pos] = servico;\r\n    } else\r\n      actualServicos[pos] = {\r\n        departamento: \"Contábil\",\r\n        prioridade: 1,\r\n        anexo: undefined,\r\n        assunto: \"\",\r\n        chat: [{ usuario: \"\", mensagem: \"\" }],\r\n        id: this.geraidservico(pos),\r\n        status: \"pendente\",\r\n        editando: false\r\n      };\r\n    this.setState(\r\n      {\r\n        servicos: [],\r\n        aberto: -1\r\n      },\r\n      () => {\r\n        this.setState({ servicos: actualServicos, aberto: pos });\r\n      }\r\n    );\r\n  }\r\n\r\n  abreservico(id) {\r\n    let servico = JSON.parse(localStorage[id]);\r\n    this.adicionaservico(servico);\r\n  }\r\n\r\n  troca_aba(pos) {\r\n    this.setState({ aberto: -1 }, () => {\r\n      this.setState({ aberto: pos });\r\n    });\r\n  }\r\n\r\n  removeservico(pos) {\r\n    console.log(\"Removing \" + pos + \"º element\");\r\n    let actualServicos = this.state.servicos;\r\n    let ppos =\r\n      pos === this.state.servicos.length - 1 ? -2 : actualServicos.length - 2;\r\n    actualServicos.splice(pos, 1);\r\n    this.setState(\r\n      {\r\n        servicos: [],\r\n        aberto: -1\r\n      },\r\n      () => {\r\n        this.setState({ servicos: actualServicos, aberto: ppos });\r\n      }\r\n    );\r\n  }\r\n\r\n  atualizaservico(pos, atual) {\r\n    let actualServicos = this.state.servicos;\r\n    actualServicos[pos] = atual;\r\n    this.setState({ servicos: actualServicos });\r\n\r\n    console.log(\r\n      \"Assunto: \" +\r\n        atual.assunto +\r\n        \"\\nMensagem: \" +\r\n        atual.chat[0].mensagem +\r\n        \"\\nUsuário: \" +\r\n        atual.chat[0].usuario +\r\n        \"\\nEditando? \" +\r\n        atual.editando +\r\n        \"\\nPrioridade: \" +\r\n        atual.prioridade +\r\n        \"\\nStatus: \" +\r\n        atual.status\r\n    );\r\n  }\r\n\r\n  salvaservico(req) {\r\n    axios.post('/api/novo/servico', req).then(res=>console.log('Serviço salvo: ' + res)).catch(err=>console.error('Falha em salvar o serviço'));\r\n    this.setState({}, () => this.setState({}));\r\n  }\r\n\r\n  geraidservico(n) {\r\n    return parseInt(((n + 1) / 13) * 1000, 10);\r\n  }\r\n\r\n  fechar_aba() {\r\n    this.setState({ servicos: [], aberto: -1 }, () => {\r\n      this.setState({ servicos: [], aberto: -1 });\r\n    });\r\n  }\r\n\r\n  servico() {\r\n    let aberto = this.state.aberto;\r\n    console.log(\"Aberto na posição \" + aberto);\r\n    let infos =\r\n      aberto !== -1\r\n        ? this.state.servicos[aberto]\r\n        : {\r\n            departamento: \"Contábil\",\r\n            prioridade: 1,\r\n            anexo: undefined,\r\n            assunto: \"\",\r\n            chat: [{ usuario: \"\", mensagem: \"\" }],\r\n            id: this.geraidservico(aberto),\r\n            status: \"pendente\",\r\n            editando: false\r\n          };\r\n    return !infos.editando ? (\r\n      <Requisicao\r\n        infos={infos}\r\n        fechar={this.removeservico}\r\n        atualizar={this.atualizaservico}\r\n        enviar={this.salvaservico}\r\n        pos={aberto}\r\n        this={this}\r\n      />\r\n    ) : (\r\n      <Chamado\r\n        mudastatus={this.altera_status_servico}\r\n        infos={infos}\r\n        atualiza={this.salvaservico}\r\n      />\r\n    );\r\n  }\r\n\r\n  home() {\r\n    return <Home />;\r\n  }\r\n\r\n  altera_status_servico(servico) {\r\n    switch (servico.status) {\r\n      case \"pendente\":\r\n        servico.status = \"resolvido\";\r\n        break;\r\n      case \"resolvido\":\r\n        servico.status = \"fechado\";\r\n        break;\r\n      case \"fechado\":\r\n        alert(\"Isso não devia aparecer\");\r\n        break;\r\n      default:\r\n        alert(\"Isso definitivamente não devia aparecer\");\r\n    }\r\n    if (servico) this.salvaservico(servico);\r\n  }\r\n\r\n  servicos() {\r\n    return (\r\n      <div style={{ display: \"flex\" }}>\r\n        <Filtro\r\n          ir_para_pagina={this.abreservico}\r\n          acao={(e, s) => {\r\n            this.altera_status_servico(e, s);\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  ir_para_pagina(n) {\r\n    this.setState({ aberto: n });\r\n  }\r\n\r\n  exibe_pagina(n) {\r\n    switch (n) {\r\n      case -2:\r\n        return this.servicos();\r\n      case -1:\r\n        return this.home();\r\n      default:\r\n        return this.servico();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let aberto = this.state.aberto;\r\n\r\n    return (\r\n      <Grid container orientation=\"row\" spacing={1}>\r\n        <Grid container item xs={12} justifyContent=\"center\">\r\n          <UpBar\r\n            servicos={this.state.servicos}\r\n            plus={this.adicionaservico}\r\n            close={this.fechar_aba}\r\n            switch={this.troca_aba}\r\n          />\r\n        </Grid>\r\n        <Grid item xs={0} md={0} />\r\n        <Grid item xs={12} md={1}>\r\n          <SideBar this={this} ir_para_pagina={this.ir_para_pagina} />\r\n        </Grid>\r\n        <Grid item sx={{ width: 1, padding: 0 }} sm={12} md={10}>\r\n          <Divider />\r\n          {this.exibe_pagina(aberto)}\r\n        </Grid>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TheMain;\r\n"]},"metadata":{},"sourceType":"module"}